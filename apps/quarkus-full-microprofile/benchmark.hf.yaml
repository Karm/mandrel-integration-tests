name: microprofile-hyperfoil
http:
  host: http://localhost:8080
  sharedConnections: 200
usersPerSec: 15
duration: 5s
scenario:
  - first:
      - httpRequest:
          # create the HTTP GET request
          GET: /data/hello
          # use different metric for webpages and other
          metric:
            - .*\.html -> pages
            - -> other
          # handler processes the response
          handler:
            # check that the response was successful
            status:
              range: 2xx
            # when completed, set the variable
            onCompletion:
              set: firstDone <- yes
          # wait for it to sync
          sync: true
      # wait for the variable to be set
      - awaitVar: firstDone

  # repeat the same scenario for other endpoints...
  - second:
      - httpRequest:
          GET: /data/secured/test
          metric:
            - .*\.html -> pages
            - -> other
          handler:
            status:
              range: 2xx
            onCompletion:
              set: secondDone <- yes
          sync: true
      - awaitVar: secondDone

  - third:
      - httpRequest:
          GET: /q/metrics
          metric:
            - .*\.html -> pages
            - -> other
          handler:
            status:
              range: 2xx
            onCompletion:
              set: thirdDone <- yes
          sync: true
      - awaitVar: thirdDone

  - fourth:
      - httpRequest:
          GET: /q/health
          metric:
            - .*\.html -> pages
            - -> other
          handler:
            status:
              range: 2xx
            onCompletion:
              set: fourthDone <- yes
          sync: true
      - awaitVar: fourthDone

  - fifth:
      - httpRequest:
          GET: /data/config/injected
          metric:
            - .*\.html -> pages
            - -> other
          handler:
            status:
              range: 2xx
            onCompletion:
              set: fifthDone <- yes
          sync: true
      - awaitVar: fifthDone

  - sixth:
      - httpRequest:
          GET: /data/client/test/bonjour
          metric:
            - .*\.html -> pages
            - -> other
          handler:
            status:
              range: 2xx
            onCompletion:
              set: sixthDone <- yes
          sync: true
      - awaitVar: sixthDone